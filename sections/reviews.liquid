<style>
    .FeaturedReviews__section {
  margin: 160px 0;
}

.FeaturedReviews__header {
  text-align: center;
}

.FeaturedReviews__header__title {
  font-weight: 400;
  font-size: 50px;
  line-height: 60px;
  margin: 0 0 24px 0;
}

.FeaturedReviews__header__content {
  display: flex;
  align-items: flex-end;
  justify-content: center;
  gap: 10px;
}

.FeaturedReviews__header__content span {
  display: flex;
  line-height: 1.3;
}

.FeaturedReviews__header__content__averageRating {
  font-size: 11px;
}

.FeaturedReviews__review {
  box-sizing: border-box;
  min-width: 333px;
  width: 333px;
  border-radius: 20px;
  padding: 30px;
  box-shadow: 0px 15px 43px 0px {{ section.settings.shadow_color }};
  background-color: {{ section.settings.box_color }};
  height: fit-content;
  display: flex;
  flex-direction: column;
}

.FeaturedReviews__wrapper {
  position: relative;
  overflow: hidden;
  padding: 40px 0;
  width: 100%;
  display: block;
}

.FeaturedReviews__slider {
  display: flex;
  gap: 25px;
  animation: none;
  align-items: center;
  cursor: grab;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
}

.FeaturedReviews__slider--dragging {
  cursor: grabbing;
  pointer-events: none;
}

@keyframes slide {
  0% {
    transform: translateX(0);
  }
  100% {
    transform: translateX(calc(-50%));
  }
}

.FeaturedReviews__slider--paused {
  animation-play-state: paused;
}

.FeaturedReviews__review__title {
  margin: 0 0 10px 0;
}

.FeaturedReviews__review__author {
  font-weight: 700;
  margin: 0;
}

.FeaturedReviews__review__content p {
  margin: 10px 0;
}

@media screen and (max-width: 820px) {
  .FeaturedReviews__section {
    margin: 100px 0 32px 0;
  }

  .FeaturedReviews__header__title {
    font-size: 32px;
    line-height: 40px;
  }

  .FeaturedReviews__slider {
    gap: 70px;
  }

  .FeaturedReviews__review {
    min-width: 280px;
    width: 280px;
  }
}

#shopify-section-{{ section.id }} .FeaturedReviews__header__title {
  color: {{ section.settings.text_color }};
}

#shopify-section-{{ section.id }} .FeaturedReviews__header__content span {
  color: {{ section.settings.text_color }};
}

#shopify-section-{{ section.id }} .FeaturedReviews__review {
  box-shadow: 0px 15px 43px 0px {{ section.settings.shadow_color }};
  background-color: {{ section.settings.box_color }};
}

#shopify-section-{{ section.id }} .FeaturedReviews__review__author {
  color: {{ section.settings.text_color }};
}
</style>

<div class="FeaturedReviews__section">
  <div class="FeaturedReviews__header">
    <h2 class="FeaturedReviews__header__title">{{ section.settings.title }}</h2>
    <div class="FeaturedReviews__header__content">
      <span>{{ section.settings.average_rating }}</span>
      <span>{{ section.settings.icon }}</span>
      <span class="FeaturedReviews__header__content__averageRating">{{ section.settings.average_rating_label }}</span>
    </div>
  </div>
  <featured-reviews-slider
    id="UGC--{{ section.id }}"
    class="FeaturedReviews__wrapper"
  >
    <div class="FeaturedReviews__slider js-featured-reviews-slider">
      {% for block in section.blocks %}
        <div class="FeaturedReviews__review">
          <span class="FeaturedReviews__review__rating">
            {% for star_index in (1..5) %}
              {% if star_index <= block.settings.rating %}
                <svg width="15" height="14" viewBox="0 0 15 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                 <path d="M7.5 10.2453L10.5417 9.47445L11.8125 13.3911L7.5 10.2453ZM14.5 5.18278H9.14583L7.5 0.141113L5.85417 5.18278H0.5L4.83334 8.30778L3.1875 13.3494L7.52083 10.2244L10.1875 8.30778L14.5 5.18278Z" fill="black"/>
                </svg>
              {% else %}
                <svg width="15" height="14" viewBox="0 0 15 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M7.30707 9.76234L6.3683 9.99541L6.67243 10.2198L4.13862 12.0471L5.30865 8.46295L5.42197 8.11582L5.1258 7.90224L2.04815 5.68278H5.85417H6.21691L6.32948 5.33795L7.5 1.75231L8.67052 5.33795L8.78309 5.68278H9.14583H12.9579L9.89568 7.90177L9.89411 7.90291L7.30707 9.76234ZM10.2099 10.072L10.8563 12.0642L8.67337 10.4535L10.2099 10.072Z" stroke="black"/>
                </svg>
              {% endif %}
            {% endfor %}
          </span>
          <h3 class="FeaturedReviews__review__title">{{ block.settings.title }}</h3>
          <div class="FeaturedReviews__review__content">{{ block.settings.content }}</div>
          <p class="FeaturedReviews__review__author">{{ block.settings.author }}</p>
        </div>
      {% endfor %}
      {% for block in section.blocks %}
        <div class="FeaturedReviews__review">
          <span class="FeaturedReviews__review__rating">
            {% for star_index in (1..5) %}
              {% if star_index <= block.settings.rating %}
                <svg width="15" height="14" viewBox="0 0 15 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                 <path d="M7.5 10.2453L10.5417 9.47445L11.8125 13.3911L7.5 10.2453ZM14.5 5.18278H9.14583L7.5 0.141113L5.85417 5.18278H0.5L4.83334 8.30778L3.1875 13.3494L7.52083 10.2244L10.1875 8.30778L14.5 5.18278Z" fill="black"/>
                </svg>
              {% else %}
                <svg width="15" height="14" viewBox="0 0 15 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M7.30707 9.76234L6.3683 9.99541L6.67243 10.2198L4.13862 12.0471L5.30865 8.46295L5.42197 8.11582L5.1258 7.90224L2.04815 5.68278H5.85417H6.21691L6.32948 5.33795L7.5 1.75231L8.67052 5.33795L8.78309 5.68278H9.14583H12.9579L9.89568 7.90177L9.89411 7.90291L7.30707 9.76234ZM10.2099 10.072L10.8563 12.0642L8.67337 10.4535L10.2099 10.072Z" stroke="black"/>
                </svg>
              {% endif %}
            {% endfor %}
          </span>
          <h3 class="FeaturedReviews__review__title">{{ block.settings.title }}</h3>
          <div class="FeaturedReviews__review__content">{{ block.settings.content }}</div>
          <p class="FeaturedReviews__review__author">{{ block.settings.author }}</p>
        </div>
      {% endfor %}
    </div>
  </featured-reviews-slider>
</div>


<script>
    if (!customElements.get('featured-reviews-slider')) {
  customElements.define(
    'featured-reviews-slider',
    class FeaturedReviewsSlider extends HTMLElement {
      constructor() {
        super();
        this.slider = this.querySelector('.js-featured-reviews-slider');
        if (!this.slider) return;
        
        this.setupInfiniteScroll();
        this.setupSlider();
        this.setupDragging();
      }

      setupInfiniteScroll() {
        const reviews = this.slider.querySelectorAll('.FeaturedReviews__review');
        reviews.forEach(review => {
          const clone = review.cloneNode(true);
          this.slider.appendChild(clone);
        });

        this.slider.style.animation = 'slide 30s linear infinite';
      }

      setupSlider() {
        this.addEventListener('mouseenter', () => {
          this.slider.classList.add('FeaturedReviews__slider--paused');
        });

        this.addEventListener('mouseleave', () => {
          if (!this.isDragging) {
            this.slider.classList.remove('FeaturedReviews__slider--paused');
          }
        });
      }

      setupDragging() {
        this.isDragging = false;
        this.startPos = 0;
        this.currentTranslate = 0;
        this.prevTranslate = 0;
        this.animationID = 0;

        // Mouse events
        this.slider.addEventListener('mousedown', this.startDragging.bind(this));
        window.addEventListener('mousemove', this.drag.bind(this));
        window.addEventListener('mouseup', this.stopDragging.bind(this));

        // Touch events
        this.slider.addEventListener('touchstart', this.startDragging.bind(this));
        window.addEventListener('touchmove', this.drag.bind(this));
        window.addEventListener('touchend', this.stopDragging.bind(this));

        // Prevent context menu
        this.slider.addEventListener('contextmenu', e => e.preventDefault());
      }

      startDragging(e) {
        this.isDragging = true;
        this.slider.classList.add('FeaturedReviews__slider--dragging');
        this.slider.classList.add('FeaturedReviews__slider--paused');
        
        // Get the starting position
        const position = e.type.includes('mouse') 
          ? e.pageX 
          : e.touches[0].clientX;
        
        this.startPos = position - this.currentTranslate;
        
        // Stop any existing animation
        this.slider.style.animation = 'none';
        cancelAnimationFrame(this.animationID);
      }

      drag(e) {
        if (!this.isDragging) return;

        e.preventDefault();
        const currentPosition = e.type.includes('mouse')
          ? e.pageX
          : e.touches[0].clientX;

        this.currentTranslate = currentPosition - this.startPos;
        this.setSliderPosition();
      }

      stopDragging() {
        this.isDragging = false;
        this.slider.classList.remove('FeaturedReviews__slider--dragging');
        
        // Reset the animation
        requestAnimationFrame(() => {
          this.slider.style.animation = 'slide 30s linear infinite';
          this.slider.style.transform = '';
        });

        // Remove the pause after a short delay
        setTimeout(() => {
          if (!this.matches(':hover')) {
            this.slider.classList.remove('FeaturedReviews__slider--paused');
          }
        }, 100);
      }

      setSliderPosition() {
        this.slider.style.transform = `translateX(${this.currentTranslate}px)`;
      }
    }
  );
}
</script>


{% schema %}
  {
    "name": "Featured Reviews",
    "settings": [
      {
        "type": "text",
        "id": "title",
        "label": "Title"
      },
      {
        "type": "text",
        "id": "average_rating",
        "label": "Average Rating"
      },
      {
        "type": "text",
        "id": "average_rating_label",
        "label": "Average Rating Label"
      },
      {
        "type": "html",
        "id": "icon",
        "label": "Stars Icon"
      },
      {
        "type": "color",
        "id": "text_color",
        "label": "Text Color",
        "default": "#000000"
      },
      {
        "type": "color",
        "id": "box_color",
        "label": "Box Background Color",
        "default": "#FFFFFF"
      },
      {
        "type": "color_background",
        "id": "shadow_color",
        "label": "Box Shadow Color",
        "default": "rgba(224, 199, 189, 0.4)"
      }
    ],
    "blocks": [
      {
        "type": "review",
        "name": "Review",
        "settings": [
          {
            "type": "text",
            "id": "title",
            "label": "Title"
          },
          {
            "type": "richtext",
            "id": "content",
            "label": "Content"
          },
          {
            "type": "text",
            "id": "author",
            "label": "Author"
          },
          {
            "type": "range",
            "id": "rating",
            "label": "Rating",
            "min": 1,
            "max": 5,
            "step": 1,
            "default": 5
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "Featured Reviews",
        "category": "Featured Reviews"
      }
    ]
  }

{% endschema %}